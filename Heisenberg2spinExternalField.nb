(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16501,        445]
NotebookOptionsPosition[     15267,        416]
NotebookOutlinePosition[     15681,        433]
CellTagsIndexPosition[     15638,        430]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]", "[", "i", "]"}], "=", 
     RowBox[{"ArcCos", "[", 
      RowBox[{"1", "-", 
       RowBox[{"2", 
        RowBox[{"Ran", "[", 
         RowBox[{"i", ",", "1"}], "]"}]}]}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Phi]", "[", "i", "]"}], "=", 
     RowBox[{"2", " ", "Pi", " ", 
      RowBox[{"Ran", "[", 
       RowBox[{"i", ",", "2"}], "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "2"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inner", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "1", "]"}], "]"}], 
     RowBox[{"Sin", "[", 
      RowBox[{"\[Theta]", "[", "2", "]"}], "]"}], 
     RowBox[{"Cos", "[", 
      RowBox[{
       RowBox[{"\[Phi]", "[", "1", "]"}], "-", 
       RowBox[{"\[Phi]", "[", "2", "]"}]}], "]"}]}], "+", 
    RowBox[{
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "1", "]"}], "]"}], 
     RowBox[{"Cos", "[", 
      RowBox[{"\[Theta]", "[", "2", "]"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"-", "2"}], 
    RowBox[{"(", 
     RowBox[{"1", "+", "inner", "-", 
      RowBox[{"h", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Ran", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "-", 
         RowBox[{"Ran", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Z", "=", 
  RowBox[{"Exp", "[", 
   RowBox[{
    RowBox[{"-", "H"}], "/", "T"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.8749180048466363`*^9, 3.8749180635470333`*^9}, {
   3.874918255634821*^9, 3.874918257167009*^9}, {3.874919426206257*^9, 
   3.8749195330882697`*^9}, {3.8749228217555733`*^9, 
   3.8749229408749375`*^9}, {3.874922975375744*^9, 3.8749230910634813`*^9}, {
   3.874923217320096*^9, 3.874923252548772*^9}, {3.874923290430791*^9, 
   3.8749232944885516`*^9}, {3.874924908706142*^9, 3.8749249459869614`*^9}, {
   3.874925023537936*^9, 3.874925070177668*^9}, {3.8749251054876223`*^9, 
   3.8749251572858953`*^9}, {3.874925369442628*^9, 3.8749254306251893`*^9}, {
   3.8749255024853196`*^9, 3.874925536025419*^9}, {3.8749258523751693`*^9, 
   3.874925890973965*^9}, {3.8749620836500816`*^9, 3.874962114623349*^9}, 
   3.874962861028018*^9, {3.874963310772168*^9, 3.8749633346320744`*^9}, {
   3.874965462879179*^9, 3.874965472919058*^9}},
 CellLabel->
  "In[130]:=",ExpressionUUID->"ad8becad-3464-4658-a165-6d3b6aaf348e"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"1", "+", 
      RowBox[{
       RowBox[{"Cos", "[", 
        RowBox[{
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"Ran", "[", 
           RowBox[{"1", ",", "2"}], "]"}]}], "-", 
         RowBox[{"2", " ", "\[Pi]", " ", 
          RowBox[{"Ran", "[", 
           RowBox[{"2", ",", "2"}], "]"}]}]}], "]"}], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Ran", "[", 
              RowBox[{"1", ",", "1"}], "]"}]}]}], ")"}], "2"]}]], " ", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             RowBox[{"Ran", "[", 
              RowBox[{"2", ",", "1"}], "]"}]}]}], ")"}], "2"]}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Ran", "[", 
           RowBox[{"1", ",", "1"}], "]"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          RowBox[{"Ran", "[", 
           RowBox[{"2", ",", "1"}], "]"}]}]}], ")"}]}], "-", 
      RowBox[{"h", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Ran", "[", 
          RowBox[{"1", ",", "1"}], "]"}], "-", 
         RowBox[{"Ran", "[", 
          RowBox[{"2", ",", "1"}], "]"}]}], ")"}]}]}], ")"}]}], 
   "T"]]], "Output",
 CellChangeTimes->{{3.874919521201481*^9, 3.8749195350850716`*^9}, 
   3.874923095239149*^9, 3.874923256739625*^9, 3.8749232973508124`*^9, 
   3.87492507803553*^9, 3.874925127173829*^9, 3.8749251592808037`*^9, 
   3.8749254311216183`*^9, 3.8749254712329664`*^9, 3.8749255127593946`*^9, 
   3.8749255435034485`*^9, 3.8749257877200556`*^9, {3.8749258747308617`*^9, 
   3.8749258972364726`*^9}, 3.874962062402871*^9, 3.874962119878361*^9, 
   3.874962862515997*^9, 3.8749633451993065`*^9, 3.8749650851694164`*^9, 
   3.874965715769538*^9},
 CellLabel->
  "Out[135]=",ExpressionUUID->"19324a34-f5e4-4d8a-85b5-0c6ac157f8ef"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Consider", " ", "no", " ", "external", " ", "field"}], ",", " ", 
    RowBox[{"thus", " ", "system", " ", "is", " ", "SO", 
     RowBox[{"(", "2", ")"}], " ", "symmetric"}]}], "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Ran", "[", 
      RowBox[{"2", ",", " ", "1"}], "]"}], " ", "=", " ", "0"}], ";"}], "\n", 
   RowBox[{
    RowBox[{
     RowBox[{"Ran", "[", 
      RowBox[{"2", ",", " ", "2"}], "]"}], " ", "=", " ", "0"}], ";"}], "\n", 
   "Z", "\n", 
   RowBox[{"Z", " ", "=", " ", 
    RowBox[{"Integrate", "[", 
     RowBox[{
      RowBox[{"Integrate", "[", 
       RowBox[{"Z", ",", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Ran", "[", 
           RowBox[{"1", ",", " ", "2"}], "]"}], ",", " ", "0", ",", " ", 
          "1"}], "}"}]}], "]"}], ",", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ran", "[", 
         RowBox[{"1", ",", " ", "1"}], "]"}], ",", " ", "0", ",", " ", "1"}], 
       "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.874965685622868*^9, 3.874965706369134*^9}},
 CellLabel->
  "In[136]:=",ExpressionUUID->"08eddebd-4e61-4f3c-8dec-21b96f230ace"],

Cell[BoxData[
 SuperscriptBox["\[ExponentialE]", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{"2", "-", 
      RowBox[{"h", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"Ran", "[", 
          RowBox[{"1", ",", "1"}], "]"}]}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"Ran", "[", 
        RowBox[{"1", ",", "1"}], "]"}]}]}], ")"}]}], "T"]]], "Output",
 CellChangeTimes->{{3.8749657018267055`*^9, 3.8749657209899893`*^9}},
 CellLabel->
  "Out[138]=",ExpressionUUID->"9397702e-67ea-4205-a656-c1ac9998ab90"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"4", "-", 
        RowBox[{"2", " ", "h"}]}], "T"]]}], ")"}], " ", "T"}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "2"}], "+", "h"}], ")"}]}]]], "Output",
 CellChangeTimes->{{3.8749657018267055`*^9, 3.8749657211630473`*^9}},
 CellLabel->
  "Out[139]=",ExpressionUUID->"c68a22a8-ade8-484d-b512-dc6eebd9b385"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{
    RowBox[{"-", "T"}], " ", 
    RowBox[{"Log", "[", "Z", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Usingle", "=", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"T", "^", "2"}]}], 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"A", "/", "T"}], ",", "T"}], "]"}], "/", "2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Cvsingle", "=", 
    RowBox[{
     RowBox[{"-", "T"}], " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"A", ",", 
        RowBox[{"{", 
         RowBox[{"T", ",", "2"}], "}"}]}], "]"}], "/", "2"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", "=", 
     RowBox[{"T", " ", 
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"Log", "[", "Z", "]"}], ",", "h"}], "]"}]}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"\[Chi]", "=", 
     RowBox[{"D", "[", 
      RowBox[{"M", ",", "h"}], "]"}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{"Usingle", ",", 
    RowBox[{"{", 
     RowBox[{"T", ",", "0.1", ",", "5", ",", "0.1"}], "}"}]}], "]"}], "/.", 
  RowBox[{"h", "->", "0"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Table", "[", 
   RowBox[{"Cvsingle", ",", 
    RowBox[{"{", 
     RowBox[{"T", ",", "0.1", ",", "5", ",", "0.1"}], "}"}]}], "]"}], "/.", 
  RowBox[{"h", "->", "0"}]}]}], "Input",
 CellChangeTimes->{{3.874963180580415*^9, 3.8749631885108805`*^9}, {
  3.8749632631649504`*^9, 3.8749632634715395`*^9}, {3.874963357163539*^9, 
  3.874963479631409*^9}, {3.8749647532705793`*^9, 3.874964790306609*^9}, {
  3.8749656518914933`*^9, 3.8749656560917864`*^9}, {3.874965734869986*^9, 
  3.8749657356500063`*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"79791e87-41a6-46f6-997d-99be48f2b727"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.9500000000000002`"}], ",", 
   RowBox[{"-", "1.900000004122307`"}], ",", 
   RowBox[{"-", "1.850003239198831`"}], ",", 
   RowBox[{"-", "1.8000908039820196`"}], ",", 
   RowBox[{"-", "1.7506711504016825`"}], ",", 
   RowBox[{"-", "1.7025485109238243`"}], ",", 
   RowBox[{"-", "1.6566188438062706`"}], ",", 
   RowBox[{"-", "1.6135673098126087`"}], ",", 
   RowBox[{"-", "1.5737663602182212`"}], ",", 
   RowBox[{"-", "1.5373147207275482`"}], ",", 
   RowBox[{"-", "1.5041219661547838`"}], ",", 
   RowBox[{"-", "1.4739874131800712`"}], ",", 
   RowBox[{"-", "1.44665778471875`"}], ",", 
   RowBox[{"-", "1.4218642198778224`"}], ",", 
   RowBox[{"-", "1.399343826961724`"}], ",", 
   RowBox[{"-", "1.378850979667704`"}], ",", 
   RowBox[{"-", "1.3601622918478495`"}], ",", 
   RowBox[{"-", "1.3430779201380412`"}], ",", 
   RowBox[{"-", "1.3274208659025089`"}], ",", 
   RowBox[{"-", "1.3130352854993312`"}], ",", 
   RowBox[{"-", "1.2997843954010158`"}], ",", 
   RowBox[{"-", "1.287548299143088`"}], ",", 
   RowBox[{"-", "1.2762219079127999`"}], ",", 
   RowBox[{"-", "1.2657130361219722`"}], ",", 
   RowBox[{"-", "1.2559407020437063`"}], ",", 
   RowBox[{"-", "1.246833635675059`"}], ",", 
   RowBox[{"-", "1.2383289817415448`"}], ",", 
   RowBox[{"-", "1.2303711793602634`"}], ",", 
   RowBox[{"-", "1.2229109978596813`"}], ",", 
   RowBox[{"-", "1.2159047085755386`"}], ",", 
   RowBox[{"-", "1.2093133739203847`"}], ",", 
   RowBox[{"-", "1.2031022369860258`"}], ",", 
   RowBox[{"-", "1.1972401970127267`"}], ",", 
   RowBox[{"-", "1.191699358052205`"}], ",", 
   RowBox[{"-", "1.1864546399712212`"}], ",", 
   RowBox[{"-", "1.1814834425542258`"}], ",", 
   RowBox[{"-", "1.1767653548637385`"}], ",", 
   RowBox[{"-", "1.1722819032185385`"}], ",", 
   RowBox[{"-", "1.168016332172055`"}], ",", 
   RowBox[{"-", "1.163953413738653`"}], ",", 
   RowBox[{"-", "1.1600792808453928`"}], ",", 
   RowBox[{"-", "1.1563812816013193`"}], ",", 
   RowBox[{"-", "1.152847851493189`"}], ",", 
   RowBox[{"-", "1.1494684010511813`"}], ",", 
   RowBox[{"-", "1.1462332168938059`"}], ",", 
   RowBox[{"-", "1.1431333743691612`"}], ",", 
   RowBox[{"-", "1.140160660269236`"}], ",", 
   RowBox[{"-", "1.1373075043131302`"}], ",", 
   RowBox[{"-", "1.1345669182803313`"}], ",", 
   RowBox[{"-", "1.131932441832188`"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.8749631891022305`*^9, 3.8749632665010996`*^9, {3.874963399166977*^9, 
   3.874963459905266*^9}, 3.874963523236285*^9, {3.874964777784031*^9, 
   3.8749647908215513`*^9}, 3.8749650968594184`*^9, {3.874965726798902*^9, 
   3.8749657388766346`*^9}},
 CellLabel->
  "Out[148]=",ExpressionUUID->"8b808ca6-36aa-489c-aa5a-f4ca512c991d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.49999999999985223`", ",", "0.49999958776930387`", ",", 
   "0.4998560353743259`", ",", "0.4977297973824776`", ",", 
   "0.489257990030187`", ",", "0.4716471291356775`", ",", 
   "0.4457898093637808`", ",", "0.41462908899759726`", ",", 
   "0.3812405918161333`", ",", "0.3479563403238579`", ",", 
   "0.31624277763631775`", ",", "0.2868764393483011`", ",", 
   "0.26016769611333085`", ",", "0.23614354301829021`", ",", 
   "0.21467445993331416`", ",", "0.1955549747941351`", ",", 
   "0.17855171445644222`", ",", "0.16343042250943257`", ",", 
   "0.14997004507306708`", ",", "0.137969169516845`", ",", 
   "0.12724811153374802`", ",", "0.117648643613687`", ",", 
   "0.10903254041193661`", ",", "0.10127961657712141`", ",", 
   "0.0942856326169947`", ",", "0.08796026732079272`", ",", 
   "0.08222525260901702`", ",", "0.07701270854883253`", ",", 
   "0.0722636844804108`", ",", "0.06792689579739893`", ",", 
   "0.06395763836521817`", ",", "0.060316859956247984`", ",", 
   "0.05697036814332094`", ",", "0.053888155492192946`", ",", 
   "0.05104382487084506`", ",", "0.048414099827693534`", ",", 
   "0.04597840705976132`", ",", "0.043718519888220564`", ",", 
   "0.041618253340228166`", ",", "0.03966320289610381`", ",", 
   "0.037840520211530115`", ",", "0.03613872018584908`", ",", 
   "0.03454751464285591`", ",", "0.03305766864276925`", ",", 
   "0.031660876074544486`", ",", "0.0303496517054401`", ",", 
   "0.029117237306245568`", ",", "0.02795751983995458`", ",", 
   "0.026864960010904756`", ",", "0.025834529730500433`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.8749631891022305`*^9, 3.8749632665010996`*^9, {3.874963399166977*^9, 
   3.874963459905266*^9}, 3.874963523236285*^9, {3.874964777784031*^9, 
   3.8749647908215513`*^9}, 3.8749650968594184`*^9, {3.874965726798902*^9, 
   3.874965738882635*^9}},
 CellLabel->
  "Out[149]=",ExpressionUUID->"ff656859-d63f-40ef-9fec-296004f94982"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"M", ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "0.1", ",", "5", ",", "0.1"}], "}"}]}], "]"}], "/.", 
    RowBox[{"h", "->", "1"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Table", "[", 
     RowBox[{"\[Chi]", ",", 
      RowBox[{"{", 
       RowBox[{"T", ",", "0.1", ",", "5", ",", "0.1"}], "}"}]}], "]"}], "/.", 
    RowBox[{"h", "->", "1"}]}]}]}]], "Input",
 CellChangeTimes->{{3.8749631423011417`*^9, 3.874963178213136*^9}, {
  3.874965577540321*^9, 3.8749655795695868`*^9}, {3.8749657435793824`*^9, 
  3.874965751959547*^9}},ExpressionUUID->"68f44405-e44e-4cb4-9219-\
0d70fd4617f2"]
},
WindowSize->{571, 598},
WindowMargins->{{Automatic, 229.5}, {2, Automatic}},
FrontEndVersion->"12.3 for Microsoft Windows (64-bit) (2021\:5e745\:670811\
\:65e5)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"921c3bd3-7e12-4ad9-95c5-dbe68ae9e9a8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 2851, 77, 260, "Input",ExpressionUUID->"ad8becad-3464-4658-a165-6d3b6aaf348e"],
Cell[3434, 101, 2203, 59, 48, "Output",ExpressionUUID->"19324a34-f5e4-4d8a-85b5-0c6ac157f8ef"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5674, 165, 1204, 34, 140, "Input",ExpressionUUID->"08eddebd-4e61-4f3c-8dec-21b96f230ace"],
Cell[6881, 201, 567, 16, 41, "Output",ExpressionUUID->"9397702e-67ea-4205-a656-c1ac9998ab90"],
Cell[7451, 219, 489, 15, 68, "Output",ExpressionUUID->"c68a22a8-ade8-484d-b512-dc6eebd9b385"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7977, 239, 1860, 57, 222, "Input",ExpressionUUID->"79791e87-41a6-46f6-997d-99be48f2b727"],
Cell[9840, 298, 2743, 59, 185, "Output",ExpressionUUID->"8b808ca6-36aa-489c-aa5a-f4ca512c991d"],
Cell[12586, 359, 1947, 34, 185, "Output",ExpressionUUID->"ff656859-d63f-40ef-9fec-296004f94982"]
}, Open  ]],
Cell[14548, 396, 715, 18, 97, "Input",ExpressionUUID->"68f44405-e44e-4cb4-9219-0d70fd4617f2"]
}
]
*)

